# 키친포스

---

## 퀵 스타트

```sh
cd docker
docker compose -p kitchenpos up -d
```

---

## 요구 사항

### 1. 상품 컨텍스트

#### 1.1 상품

- 속성
  - 상품은 식별자, 이름, 가격을 가진다.
      - 이름은 빈 값을 허용하지 않는다.
      - 아룸은 비속어를 포함할 수 없다.
      - 가격은 0원 이상이다.
- 행위
  - 상품 가격 변경
      - 상품의 가격을 변경할 수 있다.
      - 상품의 가격을 변경하면 상품을 포함한 메뉴들이 비판매 상태로 바뀔 수 있다. (자세한 사항은 메뉴 가격 정책 확인)

### 2. 메뉴 컨텍스트

#### 2.1 메뉴 그룹

- 속성
  - 메뉴 그룹은 식별자, 이름을 가진다.
      - 이름은 빈 값을 허용하지 않는다.
- 행위
  - 메뉴 그룹은 여러 개의 메뉴를 포함할 수 있다.

#### 2.2 메뉴

- 속성
  - 메뉴는 식별자, 이름, 가격, 판매 상태, 메뉴 상품 목록을 가진다.
      - 이름은 빈 값을 허용하지 않는다.
      - 아룸은 비속어를 포함할 수 없다.
      - 가격은 0원 이상이다.
      - 메뉴 상품은 순번, 수량을 가지며 하나의 상품과 대응된다.
          - 순번은 메뉴 상품이 메뉴에서 몇 번째 메뉴 상품인지 나타낸다.
          - 수량은 0 이상이다.
          - 수량 * 대응되는 상품의 가격 = 메뉴 상품 가격
      - 판매 상태는 참/거짓으로 구분한다.
          - 판매 상태인 메뉴는 판매 메뉴라고 한다.
          - 비판매 상태인 메뉴는 숨김 메뉴라고 한다.
- 행위
  - 모든 메뉴 상품 가격의 합을 **상품 가격**이라고 한다.
  - 메뉴는 단 하나의 메뉴 그룹에 포함된다.
  - 메뉴는 하나 이상의 메뉴 상품으로 구성된다.
  - 메뉴의 판매 상태를 변경할 수 있다.
  - 메뉴의 가격을 변경할 수 있다.
      - 메뉴의 가격은 상품 가격 보다 클 수 없다.
  - 메뉴 가격 정책
      - 메뉴 생성 시 가격은 0원 이상이고 상품 가격 이하여야한다.
      - 메뉴의 가격이 상품 가격보다 큰 메뉴는 모두 숨김 메뉴로 바뀐다.

### 3. 매장 주문 컨텍스트

#### 3.1 주문 테이블

- 속성
  - 주문 테이블은 식별자, 이름, 손님 수, 점유 상태를 가진다.
      - 이름은 빈 값일 수 없다.
      - 손님 수는 항상 0명 이상이다.
- 행위
  - 비점유 상태의 주문 테이블을 점유 상태로 변경할 수 있다.
    - 점유 상태의 주문 테이블은 손님 수를 변경할 수 있다.
    - 매장 주문을 할 때 점유 상태의 주문 테이블을 명시해야 한다.
  - 점유 상태의 주문 테이블을 비점유 상태로 변경할 수 있다.
    - 단, 해당 주문 테이블에서 진행중인(완료 상태가 아닌) 주문이 있으면 안 된다.
    - 비점유 상태로 변경된 주문 테이블은 손님 수가 0명으로 변경된다.

#### 3.2 매장 주문

- 속성
  - 매장 주문은 식별자, 주문 상태, 주문 시간, 주문 메뉴 목록, 주문 테이블을 가진다.
      - 주문 메뉴는 순번, 수량을 가지며 하나의 메뉴와 대응된다.
          - 순번은 주문 메뉴가 주문에서 몇 번째 주문 메뉴인지 나타낸다.
          - 수량은 0 이상이다.
          - 수량 * 대응되는 메뉴의 가격 = 주문 메뉴 가격
- 행위
  - 모든 주문 메뉴 가격의 합 = 주문 가격
  - 주문 테이블이 비점유 상태이면 주문 요청에 실패한다.
  - 주문 메뉴에 대응되는 모든 메뉴들은 판매 상태여야 하고 주문 메뉴와 가격이 일치해야 한다.
  - [매장 주문 처리 과정 자세히 보기](img/order_flow.png)

### 4. 포장 주문 컨텍스트

#### 4.1 포장 주문

- 속성
  - 포장 주문은 식별자, 주문 상태, 주문 시간, 주문 메뉴 목록을 가진다.
      - 주문 메뉴는 순번, 수량을 가지며 하나의 메뉴와 대응된다.
          - 순번은 주문 메뉴가 주문에서 몇 번째 주문 메뉴인지 나타낸다.
          - 수량은 0 이상이다.
          - 수량 * 대응되는 메뉴의 가격 = 주문 메뉴 가격
- 행위
  - 모든 주문 메뉴 가격의 합 = 주문 가격
  - 주문 메뉴에 대응되는 모든 메뉴들은 판매 상태여야 하고 주문 메뉴와 가격이 일치해야 한다.
  - [포장 주문 처리 과정 자세히 보기](img/order_flow.png)

### 5. 배송 주문 컨텍스트

#### 5.1 배송 주문

- 속성
  - 배송 주문은 식별자, 주문 상태, 주문 시간, 주문 메뉴 목록, 배송지 주소를 가진다.
      - 배송지 주소는 빈 값을 허용하지 않는다.
      - 주문 메뉴는 순번, 수량을 가지며 하나의 메뉴와 대응된다.
          - 순번은 주문 메뉴가 주문에서 몇 번째 주문 메뉴인지 나타낸다.
          - 수량은 0 이상이다.
          - 수량 * 대응되는 메뉴의 가격 = 주문 메뉴 가격
- 행위
  - 모든 주문 메뉴 가격의 합 = 주문 가격
  - 주문 메뉴에 대응되는 모든 메뉴들은 판매 상태여야 하고 주문 메뉴와 가격이 일치해야 한다.
  - 배송 주문을 수락하면 배달 대행사에게 주문 가격, 배송지 주소와 함께 배송을 요청한다.
  - [배송 주문 처리 과정 자세히 보기](img/order_flow.png)

---

## 용어 사전

### 상품 컨텍스트

| 한글명 | 영문명       | 설명                                                                               |
|-----|-----------|----------------------------------------------------------------------------------|
| 상품  | product   | **본래의 상품 그 자체**를 나타낸다. 예) 후라이드 치킨                                                |
| 비속어 | profanity | 상품의 이름에 포함될 수 없는 저급한 단어. [비속어 목록](https://www.purgomalum.com/profanitylist.html) |
| 가격  | price     | 상품의 가격으로써 메뉴의 **판매 상태**에 영향을 줄 수 있다.                                             |

### 메뉴 컨텍스트

| 한글명      | 영문명               | 설명                                                                               |
|----------|-------------------|----------------------------------------------------------------------------------|
| 메뉴       | menu              | 손님이 키친포스 메뉴판에서 확인할 수 있고 직접 주문할 수 있는 단위. 예) 후라이드+후라이드                             |
| 비속어      | profanity         | 메뉴의 이름에 포함될 수 없는 저급한 단어. [비속어 목록](https://www.purgomalum.com/profanitylist.html) |
| 메뉴 그룹    | menu group        | 비슷한 메뉴들을 묶는 단위로써 메뉴는 단 하나의 메뉴 그룹에 포함된다. 예) 두마리 치킨 세트                             |
| 메뉴 상품    | menu product      | 메뉴를 구성하는 항목이다. 메뉴는 **하나 이상**의 메뉴 상품을 포함한다. 예) 후라이드 치킨 X 2개                       |
| ┢ 상품     | ┢ product         | ┢ 메뉴 상품에 대응되는 본래의 상품을 의미한다. 예) 후라이드 치킨                                           |
| ┢ 수량     | ┢ quantity        | ┢ 메뉴 상품의 판매 개수를 나타낸다. 예) 2개                                                      |
| 메뉴 가격    | menu price        | 메뉴 자체의 가격이다. 메뉴 가격은 상품 가격과 독립적으로 정할 수 있다.                                        |
| 상품 가격    | product price     | 모든 메뉴 상품에 대응하는 **상품의 가격과 메뉴 상품의 수량을 곱해서 더한** 계산된 가격이다.                           |
| 메뉴 가격 정책 | menu price policy | 메뉴 가격이 지켜야하는 제약 사항이다. 가격 정책을 지키지 않은 메뉴는 숨김 메뉴가 된다. (현재 정책: 메뉴 가격 <= 상품 가격)       |
| 판매 메뉴    | displayed menu    | 주문이 가능한 메뉴                                                                       |
| 숨김 메뉴    | hidden menu       | 주문이 불가능한 메뉴                                                                      |

### 주문 공통

| 한글명   | 영문명             | 설명                                                        |
|-------|-----------------|-----------------------------------------------------------|
| 주문 메뉴 | order line item | 주문을 구성하는 항목들이다. 주문은 하나 이상의 주문 항목을 포함한다. 예) 후라이드+후라이드 X 1개 |
| ┢ 메뉴  | ┢ menu          | ┢ 주문 메뉴에 대응되는 본래의 메뉴를 의미한다. 예) 후라이드+후라이드                  |
| ┢ 수량  | ┢ quantity      | ┢ 몇 개의 메뉴를 주문 했는지를 의미한다. 예) 1게                            |
| 주문 가격 | order price     | 주문의 총 가격이다. 모든 주문 메뉴에 대응되는 **메뉴의 가격과 수량을 곱해서 더한 가격**이다.   ||

### 매장 주문 컨텍스트

| 한글명     | 영문명            | 설명                                                               |
|---------|----------------|------------------------------------------------------------------|
| 테이블     | table          | 손님들이 방문해서 식사하는 공간                                                |
| 빈 테이블   | empty table    | 점유가 가능한 테이블                                                      |
| 점유 테이블  | reserved table | 점유가 불가능한 테이블 (완료되지 않은 주문이 진행 중인 테이블)                             |
| 치우다     | clear          | 점유 테이블을 빈 테이블로 변경하는 행위                                           |                               |
| 주문 상태   | order status   | 주문 처리 과정에 따라 달리지는 주문의 상태다. [주문 처리 과정 자세히 보기](img/order_flow.png) |
| ┢ 대기    | ┢ waiting      | ┢ 주문을 요청한 상태                                                     |
| ┢ 수락    | ┢ accepted     | ┢ 주문을 매장에서 수락한 상태                                                |
| ┢ 전달 완료 | ┢ served       | ┢ 모든 주문 메뉴가 손님에게 전달된 상태                                          |
| ┢ 완료    | ┢ completed    | ┢ 모든 주문 과정이 끝난 상태                                                |

### 포장 주문 컨텍스트

| 한글명   | 영문명          | 설명                                                               |
|-------|--------------|------------------------------------------------------------------|
| 주문 상태 | order status | 주문 처리 과정에 따라 달리지는 주문의 상태다. [주문 처리 과정 자세히 보기](img/order_flow.png) |
| ┢ 대기  | ┢ waiting    | ┢ 주문을 요청한 상태                                                     |
| ┢ 수락  | ┢ accepted   | ┢ 주문을 매장에서 수락한 상태                                                |
| ┢ 준비  | ┢ ready      | ┢ 모든 주문 메뉴가 소님에게 전달될 수 있도록 포장된 상태                                |
| ┢ 완료  | ┢ completed  | ┢ 모든 주문 과정이 끝난 상태                                                |

### 배송 주문 컨텍스트

| 한글명          | 영문명              | 설명                                                               |
|--------------|------------------|------------------------------------------------------------------|
| 대행사          | delivery agency  | 배송을 대행하는 업체                                                      |
| 배송지          | delivery address | 주문을 배송해야하는 주소                                                    |
| 주문 상태        | order status     | 주문 처리 과정에 따라 달리지는 주문의 상태다. [주문 처리 과정 자세히 보기](img/order_flow.png) |
| ┢ 대기         | ┢ waiting        | ┢ 주문을 요청한 상태                                                     |
| ┢ 수락         | ┢ accepted       | ┢ 주문을 매장에서 수락한 상태                                                |
| ┢ 준비         | ┢ ready          | ┢ 모든 주문 메뉴가 대행사에게 전달될 수 있도록 준비된 상태                               |
| ┢ 배송중        | ┢ delivering     | ┢ 대행사가 배송 중인 주문 상태                                               |
| ┢ 배송 완료      | ┢ delivered      | ┢ 대행사가 배송을 완료한 주문 상태                                             |
| ┢ 완료         | ┢ completed      | ┢ 모든 주문 과정이 끝난 상태                                                |

---

## 모델링

### 1. 상품 컨텍스트

#### 1.1 상품

- `상품(product)`은 `이름(name)`과 `가격(price)`을 가진다.
    - `이름(name)`은 `비속어(profanity)`를 포함할 수 없다.
    - `가격(price)`은 0원 이상이다.
- `가격(price)`은 변경할 수 있다.

### 2. 메뉴

#### 2.1 메뉴 그룹

- `메뉴 그룹(menu group)`은 `이름(name)`을 가진다.
    - `이름(name)`은 `비속어(profanity)`를 포함할 수 없다.
- `메뉴 그룹(menu group)`을 통해 유사한 `메뉴(menu)`들을 모아서 볼 수 있다.

#### 2.2 메뉴

- `메뉴(menu)`는 `이름(name)`, `메뉴 가격(menu price)`, `상품 가격(product price)` `메뉴 그룹(menu group)`, `판매 상태(displayed)`
  , `메뉴 상품(menu product)` 목록을 가진다.
    - `이름(name)`은 `비속어(profanity)`를 포함할 수 없다.
    - `메뉴 가격(menu price)`은 설정하는 값이다.
        - 생성할 때 가격은 0원 이상이며 `상품 가격(product price)` 이하여야 한다.
    - `상품 가격(product price)`는 계산되는 값이다.
        - 모든 `메뉴 상품(menu product)`에 대응되는 `상품(product)`의 `가격(price)`과 `수량(quantity)`을 곱한 뒤 모두 합한
          가격이 `상품 가격(product price)`이 된다.
    - `메뉴(menu)`는 단 하나의 `메뉴 그룹(menu group)`에 속한다.
    - `판매 상태(displayed)`는 참/거짓으로 구분한다.
    - `메뉴 상품(menu product)`은 대응되는 `상품(product)`과 `수량(quantity)`으로 구성된다.
- `메뉴 가격 정책(menu price policy)`은 `메뉴 가격(menu price)`이 지켜야 하는 제약 사항이다.
    - 현재 정책: `메뉴 가격(menu price)`이 `상품 가격(product price)`보다 클 수 없다.
    - `메뉴 가격 정책(menu price policy)`을 어긴 메뉴는 `판매 상태(displayed)`가 거짓으로 바뀐다.
- `판매 상태(displayed)`를 변경할 수 있다.
    - `메뉴 가격 정책(menu price policy)`을 준수한 메뉴만 `판매 상태(displayed)`를 참으로 변경할 수 있다.
- `메뉴 가격(menu price)`을 변경할 수 있다.
    - `메뉴 가격 정책(menu price policy)`을 준수한 가격으로만 변경할 수 있다.

### 3. 매장 주문

#### 3.1 주문 테이블

- `테이블(table)`은 `이름(name)`, `점유 상태(occupied)`, `손님 수(number of guests)`를 가진다.
    - `점유 상태(occupied)`는 참/거짓으로 구분한다.
- `테이블(table)`을 치울 수 있다.
    - 완료되지 않은 주문이 있는 테이블은 치울 수 없다.
    - `점유 상태(occupied)`가 거짓으로 변경된다.
    - `손님 수(number of guests)`가 0명으로 변경된다.
- `손님 수(number of guests)`를 변경할 수 있다.
    - `점유 상태`가 참인 테이블만 가능하다.

#### 3.2 매장 주문

- `매장 주문(eat in order)`은 `주문 상태(order status)`, `주문 시간(order date time)`, `주문 메뉴(order line item)` 목록, `테이블(table)`을
  가진다.
    - `주문 상태(order status)`는 `대기(waiting)`, `수락(accepted)`, `전달 완료(served)`, `완료(completed)` 총 네 가지다.
    - [주문 상태 변화 과정](img/order_flow.png)
    - `주문 메뉴(order line item)`는 대응되는 `메뉴(menu)`와 `수량(quantity)`로 구성된다.
        - 존재하지 않는 메뉴가 포함되면 주문할 수 없다.
        - 모든 메뉴는 `판매 상태(displayed)`여야한다.
- 모든 `주문 메뉴(order line item)`들의 `메뉴(menu)`의 가격과 `수량(order line quantity)`을 곱한 뒤 모두 합한 가격이 `주문 가격(order price)`이 된다.
- 주문 요청 시 `점유 상태(occupied)`가 참인 `테이블(table)`을 명시해야 한다.

### 4. 포장 주문

#### 4.1 포장 주문

- `포장 주문(pickup order)`은 `주문 상태(order status)`, `주문 시간(order date time)`, `주문 메뉴(order line item)` 목록을 가진다.
    - `주문 상태(order status)`는 `대기(waiting)`, `수락(accepted)`, `준비(ready)`, `완료(completed)` 총 네 가지다.
    - [주문 상태 변화 과정](img/order_flow.png)
    - `주문 메뉴(order line item)`는 대응되는 `메뉴(menu)`와 `수량(quantity)`로 구성된다.
        - 존재하지 않는 메뉴가 포함되면 주문할 수 없다.
        - 모든 메뉴는 `판매 상태(displayed)`여야한다.
- 모든 `주문 메뉴(order line item)`들의 `메뉴(menu)`의 가격과 `수량(order line quantity)`을 곱한 뒤 모두 합한 가격이 `주문 가격(order price)`이 된다.

### 5. 배송 주문

#### 5.1 포장 주문

- `매장 주문(eat in order)`은 `주문 상태(order status)`, `주문 시간(order date time)`, `주문 메뉴(order line item)`
  목록, `배송지(delivery address)`를 가진다.
    - `주문 상태(order status)`는 `대기(waiting)`, `수락(accepted)`, `준비(ready)`, `배송중(delivering)`, `배송 완료(delivered)`
      , `완료(completed)` 총 여섯 가지다.
    - [주문 상태 변화 과정](img/order_flow.png)
    - `주문 메뉴(order line item)`는 대응되는 `메뉴(menu)`와 `수량(quantity)`로 구성된다.
        - 존재하지 않는 메뉴가 포함되면 주문할 수 없다.
        - 모든 메뉴는 `판매 상태(displayed)`여야한다.
- 모든 `주문 메뉴(order line item)`들의 `메뉴(menu)`의 가격과 `수량(order line quantity)`을 곱한 뒤 모두 합한 가격이 `주문 가격(order price)`이 된다.
- `주문 상태(order status)`를 `수락(accepted)`으로 변경할 때 `대행사(delivery agency)`에 `주문 가격(order price)`, `배송지(delivery address)`를
  전달하여 배송을 요청한다.  




